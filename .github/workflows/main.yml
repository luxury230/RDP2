runs-on: windows-latest

steps:
  - name: Enable RDP
    run: |
      Set-ItemProperty -Path 'HKLM:\System\CurrentControlSet\Control\Terminal Server' -Name "fDenyTSConnections" -Value 0
      Enable-NetFirewallRule -DisplayGroup "Remote Desktop"

  - name: Verify RDP Accessibility
    run: |
      Write-Host "Testing RDP Port..."
      $testResult = Test-NetConnection -ComputerName localhost -Port 3389
      if (-not $testResult.TcpTestSucceeded) { exit 1 }
      Write-Host "RDP Port OK!"

  - name: Maintain Connection
    run: |
      Write-Host "RDP IP: $(hostname -I)"
      while ($true) { Start-Sleep -Seconds 300 }
      
